<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unlock the Lab Workshop</title>
    <link rel="icon" type="image/x-icon" href="/assets/favicon-CLtBlbIg.ico">
  <script type="module" crossorigin src="/assets/main-B7f5ZopD.js"></script>
  <link rel="modulepreload" crossorigin href="/assets/modulepreload-polyfill-B5Qt9EMX.js">
  <link rel="modulepreload" crossorigin href="/assets/firebase-4YSElDcj.js">
  <link rel="modulepreload" crossorigin href="/assets/firebase-config-CwzURld3.js">
  <link rel="stylesheet" crossorigin href="/assets/firebase-config-BrlD7rBN.css">
</head>
<body>
    <div id="app">
        <!-- Score Display (appears after first rating) -->
        <div id="score-banner" class="score-banner" style="display: none;">
            <span id="total-score-header"><span class="medal-icon">ğŸ†</span> 0</span>
            <div class="navbar-center">
                <img id="navbar-logo" src="unlock-lab-icon.svg" alt="Logo" class="navbar-logo">
            </div>
            <div class="navbar-right">
                <span id="navbar-paper-number" class="navbar-paper-number" style="display: none;"></span>
                <span id="navbar-username" class="navbar-username"></span>
            </div>
        </div>
        
        <!-- Page 1: Welcome -->
        <div class="page active" id="page-welcome">
            <div class="container">
                <h1><img id="logo-icon" src="unlock-lab-icon.svg" alt="Unlock the Lab" style="height: 3rem; flex-shrink: 0; cursor: pointer;"> <span class="logo-text">Unlock the Lab</span></h1>
                <h2>Your guide to reading science like a scientist</h2>
                
                <div class="content">
                    <p class="intro-text">"Chocolate makes you smarter!"â€”Headlines promise miracles and threaten disasters, but what does the actual science say?</p>
                    
                    <p>In this interactive workshop, you'll become a science detective. You'll evaluate real-world research scenarios using the same criteria professional scientists use to judge quality.</p>
                    
                    <div class="info-box" style="background: #fff3cd; border-left: 4px solid #ffc107;">
                        <h3 style="margin-top: 0;">ğŸ¯ Your mission</h3>
                        <p><strong>Dual challenge:</strong> For each study, complete both steps in this order:</p>
                        <ol style="margin: 10px 0; padding-left: 2.5rem;">
                            <li><strong>Predict the crowd</strong> â€” Guess how the average participant will rate it (1â€“7 scale)</li>
                            <li><strong>Judge the science</strong> â€” Give your own quality rating using expert criteria (1â€“7 scale)</li>
                        </ol>
                        <p style="margin-bottom: 0.75rem;"><strong>Scoring:</strong> Points awarded based on how accurately your crowd prediction matches the actual average. Can you think like a scientist AND anticipate how others perceive research?</p>
                        <p style="font-size: 0.9rem; color: #856404; margin-bottom: 0;"><strong>Why both?</strong> This dual approach lets you express your own beliefs about research quality while reflecting on how those beliefs might differ from others' perspectives.</p>
                    </div>
                    
                    <h3>ğŸ“š What You'll Learn:</h3>
                    <ul class="skills-list">
                        <li>âœ… Spot red flags in research (predatory journals, hidden data, clickbait)</li>
                        <li>âœ… Distinguish good science from marketing disguised as research</li>
                        <li>âœ… Understand why open access and transparency matter</li>
                        <li>âœ… Evaluate methodology, sample sizes, and conclusions critically</li>
                    </ul>
                    
                    <p class="highlight" style="font-size: 1.1rem; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 8px; text-align: center; text-shadow: 0 1px 3px rgba(0,0,0,0.3); font-weight: 500;">ğŸ’¡ First, you'll learn the tools. Then, you'll test your skills on real scenarios!</p>
                    
                    <div style="margin-top: 2rem; padding: 1.25rem; background: #fff3e0; border: 2px solid #ff9800; border-radius: 8px;">
                        <h3 style="margin-top: 0; color: #e65100; font-size: 1rem;">ğŸ† Leaderboard & Anonymous Usernames</h3>
                        <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 0.75rem;">Complete the workshop (or finish early at any point) to appear on the <strong>public leaderboard</strong> and to review and compare your ratings with the crowd.</p>
                        <ul style="font-size: 0.9rem; line-height: 1.6; margin: 0.75rem 0; padding-left: 1.5rem;">
                            <li>You'll be assigned a <strong>unique anonymous username</strong> (e.g., "Red Fox", "Wise Owl") automatically.</li>
                            <li>Your username will be displayed on the <strong>results page at the end</strong>.</li>
                            <li>Rankings are based on how accurately you predict the crowd's average ratings.</li>
                            <li>Earn badges (ğŸ†ğŸ¥‡ğŸ¥ˆğŸ¥‰) based on your prediction accuracy score.</li>
                        </ul>
                        <p style="font-size: 0.85rem; color: #64748b; margin-bottom: 0;">View the live leaderboard at any time on the <a href="dashboard.html" target="_blank" style="color: #2563eb;">public dashboard</a>.</p>
                    </div>
                    
                    <div style="margin-top: 2rem; padding: 1.25rem; background: #f0f9ff; border: 2px solid #3b82f6; border-radius: 8px;">
                        <h3 style="margin-top: 0; color: #1e40af; font-size: 1rem;">ğŸ“Š Data Use Notice</h3>
                        <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 0.75rem;">By participating in this task, you agree that your <strong>anonymous data will be used for research purposes</strong> and may be shared and analysed.</p>
                        <ul style="font-size: 0.9rem; line-height: 1.6; margin: 0.75rem 0; padding-left: 1.5rem;">
                            <li>Your data is identified only by an <strong>automatically assigned anonymous username</strong>.</li>
                            <li>Your username will be displayed on the <strong>results page at the end</strong>.</li>
                            <li>You need not share this username with anyone if you do not wish to.</li>
                            <li><strong>No demographic details</strong> or personally identifiable information is collected.</li>
                        </ul>
                        <p style="font-size: 0.85rem; color: #64748b; margin-bottom: 0;">All data is fully anonymised and used solely for understanding how people evaluate research quality.</p>
                    </div>
                    
                    <div style="margin-top: 2rem; padding: 1rem; background: #f8fafc; border-radius: 8px; font-size: 0.9rem; color: #64748b;">
                        <p style="margin-bottom: 0.5rem;"><strong>Author:</strong> Dr Pablo Bernabeu, Department of Education, University of Oxford</p>
                        <p style="margin-bottom: 0.5rem; font-size: 0.85rem; color: #64748b;"><strong>Legal disclaimer:</strong> This app and workshop were created by Dr Pablo Bernabeu in a personal capacity during spare time. The employer is not affiliated with, does not endorse, and bears no liability for this app or workshop.</p>
                        <p style="margin-bottom: 0.5rem;"><strong>Materials:</strong> <a href="https://github.com/pablobernabeu/Unlock_the_Lab" target="_blank" rel="noopener noreferrer" style="color: #2563eb;">github.com/pablobernabeu/Unlock_the_Lab</a></p>
                        <p style="margin-bottom: 0.5rem;"><strong>Licence:</strong> <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" style="color: #2563eb;">CC BY 4.0</a> â€” Free to use with attribution</p>
                        <p style="margin-bottom: 0; font-size: 0.85rem; font-style: italic;">ğŸ’¡ Contributions welcome! Suggest improvements or report issues on <a href="https://github.com/pablobernabeu/Unlock_the_Lab/issues" target="_blank" rel="noopener noreferrer" style="color: #2563eb;">GitHub</a>.</p>
                    </div>
                </div>
                
                <button class="btn-primary" onclick="nextPage()" style="margin-top: 1.5rem;">Get started</button>
                
                <!-- Admin Link -->
                <p style="text-align: right; margin-top: 3rem; font-size: 0.8rem;"><a href="admin.html" style="color: #94a3b8; text-decoration: none;">Admin</a></p>
            </div>
        </div>

        <!-- Page 2: Glossary and Rubric -->
        <div class="page" id="page-guide">
            <div class="container">
                <div class="page-logo-header">
                    <img id="guide-logo" src="unlock-lab-icon.svg" alt="Logo" class="page-logo">
                </div>
                <h1>ğŸ“š Before We Begin</h1>
                
                <div class="content">
                    <div class="info-box" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
                        <p style="margin: 0;"><strong>ğŸ“– Take your time with these resources!</strong> They're the foundation for evaluating research quality. You can return to them anytime using the ğŸ“– button.</p>
                    </div>
                    
                    <h2 style="margin-top: 1.5rem;">ğŸ“š Scientific Glossary</h2>
                    <p style="color: #666; margin-bottom: 1rem;">Key terms you'll encounter when evaluating research:</p>
                    <div id="glossary-content"></div>
                    
                    <h2 style="margin-top: 2.5rem;">âš–ï¸ Quality Rating Rubric (1-7 Scale)</h2>
                    <p style="color: #666; margin-bottom: 1rem;">Use these six criteria to rate each study. Consider all aspects together for your final score:</p>
                    <div id="rubric-content"></div>
                </div>
                
                <div style="display: flex; gap: 1rem; justify-content: space-between; align-items: stretch;">
                    <button class="btn-secondary" style="align-self: stretch; display: flex; align-items: center;" onclick="previousPage()">â† Back</button>
                    <button class="btn-primary" onclick="nextPage()">Start rating papers â†’</button>
                </div>
            </div>
        </div>

        <!-- Paper Pages (Generated Dynamically) -->
        <div id="paper-pages"></div>

        <!-- Final Page: Recap -->
        <!-- Token Allocation Page -->
        <div class="page" id="page-ranking">
            <div class="container">
                <h1>âš–ï¸ What Matters Most to You?</h1>
                <div class="content">
                    <div class="info-box" style="margin-bottom: 1.5rem;">
                        <h3 style="margin-top: 0; color: #667eea;">Instructions</h3>
                        <p style="margin-bottom: 0.75rem;">You have <strong>20 tokens</strong> to distribute across the six criteria you used to evaluate the studies. The more tokens you assign to a criterion, the more important it is to you.</p>
                        <p style="margin-bottom: 0.75rem;"><strong>How to use:</strong> Tap any box in a row to fill all boxes from the left up to that position. Tap the last filled box again to clear that criterion's tokens.</p>
                        <p style="margin: 0;"><strong>Please allocate all 20 tokens</strong> before proceeding to your results.</p>
                    </div>

                    <div style="margin-bottom: 1.5rem;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <span style="font-weight: 600; color: #374151;">Tokens used:</span>
                            <span style="font-weight: 700; font-size: 1.1rem; color: #667eea;"><span id="tokens-used-display">0</span> / 20</span>
                        </div>
                        <div style="background: #e5e7eb; border-radius: 8px; height: 10px; overflow: hidden;">
                            <div id="token-progress-fill" style="height: 100%; width: 0%; background: linear-gradient(90deg, #667eea, #764ba2); border-radius: 8px; transition: width 0.2s ease;"></div>
                        </div>
                    </div>

                    <div id="criteria-token-grid"></div>

                    <button id="submit-ranking-btn" class="btn-primary" onclick="submitRanking()" disabled
                        style="margin-top: 1.5rem; width: 100%; padding: 1rem; opacity: 0.5; font-size: 1rem;">
                        Allocate all 20 tokens to continue
                    </button>
                </div>
            </div>
        </div>

        <div class="page" id="page-final">
            <div class="container">
                <h1>ğŸ‰ Workshop Complete!</h1>
                
                <div class="content">
                    
                    <!-- PART 1: PREDICTION PERFORMANCE -->
                    <div style="margin-bottom: 3rem; padding: 2rem; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border-radius: 12px; color: white;">
                        <h2 style="margin-top: 0; color: white; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 1rem;">
                            ğŸ¯ Part 1: Your Prediction Performance
                        </h2>
                        <p style="font-size: 1.05rem; margin-bottom: 1.5rem;">
                            How well did you predict what others would rate each study?
                        </p>
                        
                        <div class="final-score-card" style="background: white; color: #1f2937;">
                            <h3 style="color: #059669;">Your Prediction Accuracy Score</h3>
                            <div class="final-score" id="final-score">0</div>
                            <div class="score-rank" id="score-rank">Calculating rank...</div>
                            <p style="font-size: 0.9rem; color: #666; margin-top: 1rem;">
                                This score measures how accurately you predicted the crowd's average ratings. Higher scores mean better predictions!
                            </p>
                        </div>
                        
                        <div class="leaderboard" style="background: rgba(255,255,255,0.95); border-radius: 8px; padding: 1.25rem; margin-top: 1.25rem;">
                            <h3 style="color: #059669; margin-top: 0; text-shadow: none;">ğŸ† Top Predictors</h3>
                            <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                                See how your prediction accuracy compares to other participants
                            </p>
                            <div id="leaderboard-list">Loading...</div>
                        </div>
                    </div>
                    
                    <!-- PART 2: YOUR RATING PROFILE -->
                    <div style="margin-bottom: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white;">
                        <h2 style="margin-top: 0; color: white; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 1rem; font-weight: 600; text-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                            ğŸ“Š Part 2: Your Rating Profile
                        </h2>
                        <p style="font-size: 1.05rem; margin-bottom: 1.5rem; font-weight: 300;">
                            How did your own quality ratings compare to the crowd's ratings?
                        </p>
                        
                        <!-- Personalized Rating Analysis -->
                        <div id="rating-analysis" style="display: none;">
                            <div style="background: rgba(255,255,255,0.95); color: #1f2937; padding: 1rem; border-radius: 10px; margin: 1rem 0;">
                                <p id="analysis-summary" style="font-size: 1.05rem; line-height: 1.7; margin: 0;"></p>
                            </div>
                            <div style="background: white; border-radius: 10px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin: 1rem 0;">
                                <h3 style="color: #20B2AA; margin-top: 0; text-shadow: none;">Your Ratings vs. Crowd Average</h3>
                                <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                                    This chart shows how your quality ratings (purple line) compared to what other participants rated on average (green dashed line).
                                </p>
                                <div style="position: relative; height: 220px;">
                                    <canvas id="comparison-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- PART 3: CRITERION IMPORTANCE -->
                    <div id="criterion-importance-section" style="margin-bottom: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); border-radius: 12px; color: white;">
                        <h2 style="margin-top: 0; color: white; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 1rem; font-weight: 600; text-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                            âš–ï¸ Part 3: Your Criterion Weightings
                        </h2>
                        <p style="font-size: 1.05rem; margin-bottom: 1rem; font-weight: 300;">
                            Here is how you weighted the six evaluation criteria.
                        </p>
                        <div id="criterion-importance-bars" style="background: rgba(255,255,255,0.95); color: #1f2937; padding: 1rem; border-radius: 10px;">
                            <p style="text-align: center; color: #9ca3af; margin: 0;">Loading...</p>
                        </div>
                    </div>

                    <h2>You've evaluated <span id="total-papers">0</span> research papers!</h2>
                    <ul style="line-height: 1.8; padding-left: 2rem; margin: 1.5rem 0;">
                        <li style="margin-bottom: 0.75rem;"><strong>ğŸ”“ Open Access</strong> â€” Paywalls hide science from public scrutiny. Demand transparency!</li>
                        <li style="margin-bottom: 0.75rem;"><strong>ğŸš¨ Spotting Clickbait</strong> â€” Sensational titles usually mean weak science underneath</li>
                        <li style="margin-bottom: 0.75rem;"><strong>ğŸ”¬ Methodology Matters</strong> â€” Sample sizes, controls, and open data separate real from fake</li>
                        <li style="margin-bottom: 0.75rem;"><strong>ğŸ“š Source Credibility</strong> â€” Predatory journals publish anything for money. Trust matters</li>
                        <li style="margin-bottom: 0.75rem;"><strong>âš–ï¸ Nuanced Conclusions</strong> â€” Good scientists admit what they don't know. Beware certainty!</li>
                        <li style="margin-bottom: 0.75rem;"><strong>ğŸŒ Crowd vs. Experts</strong> â€” You learned how public perception differs from scientific quality</li>
                    </ul>
                    
                    <div class="info-box">
                        <h3>Keep Exploring Science!</h3>
                        <p>When reading science news:</p>
                        <ul style="line-height: 1.7; padding-left: 2rem; margin: 0.75rem 0;">
                            <li style="margin-bottom: 0.5rem;">Look for the original research paper</li>
                            <li style="margin-bottom: 0.5rem;">Check if data is openly available</li>
                            <li style="margin-bottom: 0.5rem;">Question sensational claims</li>
                            <li style="margin-bottom: 0.5rem;">Consider the source and methodology</li>
                        </ul>
                    </div>
                    
                    <div style="text-align: center; margin-top: 2rem;">
                        <h3>Curious About the Results?</h3>
                        <p>See how all participants rated the studies, including average scores, rating distributions, and agreement levels across the group.</p>
                        <a href="dashboard.html" class="btn-primary" style="display: inline-block; text-decoration: none; margin-top: 1rem;">
                            ğŸ“Š View Live Dashboard
                        </a>
                        <p style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">
                            Real-time ratings and statistics from all participants
                        </p>
                        
                        <!-- Save Your Results Section -->
                        <div id="save-results-section" style="margin-top: 2rem; padding: 1.25rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: rgba(255,255,255,0.95);">
                            <h3 style="margin-top: 0; color: white; font-weight: 600; text-shadow: 0 1px 3px rgba(0,0,0,0.3);">ğŸ’¾ Save Your Results</h3>
                            <div style="background: rgba(255,255,255,0.15); padding: 0.75rem 1rem; border-radius: 8px; margin-bottom: 1rem; text-align: center;">
                                <p style="margin: 0; font-size: 0.9rem; font-weight: 400; opacity: 0.9;">Your username:</p>
                                <p style="margin: 0.25rem 0 0 0; font-size: 1.1rem; font-weight: 700; color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.2);" id="username-display-save"></p>
                            </div>
                            <p style="margin-bottom: 1rem; font-size: 0.95rem; font-weight: 400;">
                                Want to review your personalized analysis later? Save your results link now! You can return to this page anytime to see:
                            </p>
                            <ul style="margin-bottom: 1rem; padding-left: 2.25rem; font-size: 0.95rem; line-height: 1.8; list-style: disc; list-style-position: outside; font-weight: 400; color: rgba(255,255,255,0.98);">
                                <li style="margin-bottom: 0.65rem;">Your rating profile and statistical comparison</li>
                                <li style="margin-bottom: 0.65rem;">How your ratings compare to the crowd average</li>
                                <li style="margin-bottom: 0.65rem;">Your complete prediction accuracy scores</li>
                            </ul>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
                                <button id="save-results-link" class="btn-secondary" style="display: none; padding: 0.75rem 1.5rem; background: white; color: #667eea; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; font-weight: 600;" onclick="copyResultsLink()">
                                    ğŸ”— Copy link to your results
                                </button>
                                <button id="email-results-link" class="btn-secondary" style="display: none; padding: 0.75rem 1.5rem; background: white; color: #667eea; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; font-weight: 600;" onclick="emailResultsLink()">
                                    ğŸ“§ Email my results
                                </button>
                            </div>
                            <p id="link-copied-msg" style="display: none; font-size: 0.9rem; color: #fef3c7; margin-top: 0.75rem; text-align: center;">
                                âœ“ Link copied! Save it to return to your results anytime.
                            </p>
                            <p style="margin-top: 1.5rem; font-size: 0.9rem; font-weight: 400; text-align: center;">
                                Or visit the <a href="dashboard.html" style="color: white; text-decoration: underline; font-weight: bold;">live dashboard</a> and enter your name (<strong id="username-display-inline" style="font-weight: 600;"></strong>) to find your results.
                            </p>
                        </div>
                        
                    </div>
                    
                    <p style="text-align: center; margin-top: 2rem; font-size: 1.2rem;">
                        Thank you for participating! ğŸ”¬âœ¨
                    </p>
                    
                    <div style="margin-top: 2.5rem; padding: 1.5rem; background: #f8fafc; border-radius: 8px; border-left: 4px solid #2563eb;">
                        <h3 style="margin-top: 0; color: #2563eb;">ğŸ“‹ Workshop Information</h3>
                        <p style="margin-bottom: 0.75rem; color: #64748b;"><strong>Author:</strong> Dr Pablo Bernabeu<br>Department of Education, University of Oxford</p>
                        <p style="margin-bottom: 0.75rem; color: #64748b;"><strong>App Materials:</strong> <a href="https://github.com/pablobernabeu/Unlock_the_Lab" target="_blank" rel="noopener noreferrer" style="color: #2563eb; text-decoration: none; border-bottom: 1px solid #2563eb;">github.com/pablobernabeu/Unlock_the_Lab</a></p>
                        <p style="margin-bottom: 0; color: #64748b;"><strong>Licence:</strong> <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" style="color: #2563eb; text-decoration: none; border-bottom: 1px solid #2563eb;">CC BY 4.0 Attribution</a> â€” You're free to use and adapt these materials provided you acknowledge the authorship.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Help Button (appears on paper pages) -->
    <button id="help-button" class="floating-btn" onclick="showHelp()">
        ğŸ“–
    </button>

    <!-- Modal for Glossary/Rubric -->
    <div id="help-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeHelp()">&times;</span>
            <div class="modal-tabs">
                <button class="tab-btn active" onclick="showTab('glossary')">Glossary</button>
                <button class="tab-btn" onclick="showTab('rubric')">Rating rubric</button>
            </div>
            <div id="modal-glossary" class="tab-content active"></div>
            <div id="modal-rubric" class="tab-content"></div>
        </div>
    </div>

    <!-- App Scripts (ES Modules) -->
</body>
</html>
