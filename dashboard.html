<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unlock the Lab - Live Dashboard</title>
    <link rel="icon" type="image/x-icon" href="/assets/favicon-CLtBlbIg.ico">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: white;
            border-radius: 12px;
            padding: 20px 30px 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            background: linear-gradient(135deg, #20B2AA 0%, #48d1cc 30%, #ff9a56 70%, #ff6b35 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
            font-size: 2rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            line-height: 1;
        }

        .dashboard-logo {
            height: 2rem;
            flex-shrink: 0;
            margin-bottom: 0.3rem;
            cursor: pointer;
            animation: logoShake 2s ease-in-out infinite;
            transform-origin: center;
        }

        .dashboard-logo.shake-intense {
            animation: logoShakeIntense 0.3s ease-in-out infinite;
        }

        .dashboard-logo.flipping {
            animation: logoFlipWithShake 4s ease-in-out forwards;
        }

        @keyframes logoShake {
            0% { transform: rotate(0deg); }
            12.5% { transform: rotate(-4deg); }
            25% { transform: rotate(-8deg); }
            37.5% { transform: rotate(-4deg); }
            50% { transform: rotate(0deg); }
            62.5% { transform: rotate(4deg); }
            75% { transform: rotate(8deg); }
            87.5% { transform: rotate(4deg); }
            100% { transform: rotate(0deg); }
        }

        @keyframes logoShakeIntense {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-15deg); }
            75% { transform: rotate(15deg); }
        }

        @keyframes logoFlipWithShake {
            0% { transform: rotate(0deg); }
            2% { transform: rotate(-15deg); }
            4% { transform: rotate(15deg); }
            6% { transform: rotate(-12deg); }
            8% { transform: rotate(12deg); }
            10% { transform: rotate(-8deg); }
            12% { transform: rotate(8deg); }
            15% { transform: rotate(180deg); }
            85% { transform: rotate(180deg); }
            100% { transform: rotate(360deg); }
        }

        .droplet-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }

        .droplet {
            position: absolute;
            background: radial-gradient(ellipse at 50% 30%, #ffaa33 0%, #ff8c42 40%, #ff6b35 70%, #cc5528 100%);
            border-radius: 50%;
            opacity: 0;
            box-shadow:
                0 2px 6px rgba(255, 107, 53, 0.5),
                0 4px 12px rgba(255, 107, 53, 0.3),
                inset 0 -2px 4px rgba(0, 0, 0, 0.2),
                inset 0 2px 4px rgba(255, 200, 100, 0.3);
            animation: dropletDrop 3s cubic-bezier(0.4, 0, 0.6, 1) forwards;
        }

        @keyframes dropletDrop {
            0% {
                opacity: 0;
                transform: translateY(0) scale(0.5);
            }
            5% {
                opacity: 0.9;
                transform: translateY(10px) scale(1);
            }
            15% {
                transform: translateY(30px) scale(2);
            }
            40% {
                transform: translateY(50vh) scale(4);
            }
            70% {
                transform: translateY(80vh) scale(6);
            }
            100% {
                opacity: 0.3;
                transform: translateY(120vh) scale(8);
            }
        }

        .droplet-star {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #ffaa00 100%);
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            border-radius: 0;
            box-shadow:
                0 0 10px rgba(255, 215, 0, 0.8),
                0 0 20px rgba(255, 215, 0, 0.5),
                0 2px 6px rgba(255, 170, 0, 0.5);
        }

        .droplet-heart {
            background: linear-gradient(135deg, #ff69b4 0%, #ff1493 50%, #c71585 100%);
            border-radius: 0;
            box-shadow:
                0 0 8px rgba(255, 105, 180, 0.6),
                0 2px 6px rgba(255, 20, 147, 0.4);
        }

        .droplet-heart::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: inherit;
            border-radius: 50% 50% 0 0;
            transform: rotate(-45deg);
            transform-origin: 0 100%;
        }

        .droplet-heart::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: inherit;
            border-radius: 50% 50% 0 0;
            transform: rotate(45deg);
            transform-origin: 100% 100%;
        }

        .droplet-sparkle {
            background: radial-gradient(circle, #ffffff 0%, #add8e6 40%, #4bb3e3 100%);
            border-radius: 50%;
            box-shadow:
                0 0 15px rgba(255, 255, 255, 1),
                0 0 30px rgba(173, 216, 230, 0.8),
                0 0 45px rgba(75, 179, 227, 0.6);
        }

        .droplet-bubble {
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.9) 0%, rgba(173, 216, 230, 0.6) 50%, rgba(135, 206, 235, 0.3) 100%);
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.5);
            box-shadow:
                inset 0 -10px 20px rgba(135, 206, 235, 0.3),
                inset 0 10px 20px rgba(255, 255, 255, 0.5),
                0 0 10px rgba(173, 216, 230, 0.4);
        }

        @keyframes dropletRefill {
            0% {
                opacity: 0;
                transform: translateY(0) scale(2.5);
            }
            8% {
                opacity: 0.95;
                transform: translateY(calc(var(--travel-distance) * 0.15)) scale(2);
            }
            25% {
                opacity: 1;
                transform: translateY(calc(var(--travel-distance) * 0.4)) scale(1.2);
            }
            50% {
                opacity: 0.9;
                transform: translateY(calc(var(--travel-distance) * 0.65)) scale(0.6);
            }
            75% {
                opacity: 0.6;
                transform: translateY(calc(var(--travel-distance) * 0.85)) scale(0.25);
            }
            90% {
                opacity: 0.3;
                transform: translateY(calc(var(--travel-distance) * 0.95)) scale(0.1);
            }
            100% {
                opacity: 0;
                transform: translateY(var(--travel-distance)) scale(0.05);
            }
        }

        .droplet-refill {
            animation: dropletRefill 1.1s cubic-bezier(0.25, 0, 0.1, 1) forwards;
        }

        h1 {
            color: #20B2AA;
            font-size: 2rem;
            margin-bottom: 4px;
        }

        .status {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #666;
            font-size: 0.9rem;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #20B2AA;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .chart-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .chart-card h2 {
            color: #20B2AA;
            font-size: 1.3rem;
            margin-bottom: 20px;
        }

        .chart-container {
            position: relative;
            height: 400px;
            cursor: pointer;
        }

        .data-table {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }

        th {
            background: #f9fafb;
            color: #20B2AA;
            font-weight: 600;
            cursor: pointer;
            user-select: none;
            position: relative;
            padding-right: 25px;
        }

        th:hover {
            background: #f3f4f6;
        }

        th.sortable::after {
            content: '‚áÖ';
            position: absolute;
            right: 8px;
            color: #9ca3af;
            font-size: 0.8em;
        }

        th.sort-asc::after {
            content: '‚Üë';
            color: #20B2AA;
        }

        th.sort-desc::after {
            content: '‚Üì';
            color: #20B2AA;
        }

        tbody tr:hover {
            background: #f9fafb;
        }

        /* Color scale cells */
        .color-scale {
            font-weight: 600;
            border-radius: 4px;
            padding: 6px 12px !important;
        }

        .quality-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .quality-high { background: #10b981; }
        .quality-medium { background: #f59e0b; }
        .quality-low { background: #ef4444; }

        .admin-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .admin-overlay.active {
            display: flex;
        }

        .admin-panel {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .admin-panel h3 {
            color: #20B2AA;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .admin-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 15px;
        }

        .admin-input:focus {
            outline: none;
            border-color: #20B2AA;
        }

        .admin-timer {
            text-align: center;
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .admin-timer.warning {
            color: #ef4444;
            font-weight: bold;
        }

        .admin-buttons {
            display: flex;
            gap: 10px;
        }

        .admin-buttons button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-cancel {
            background: #e5e7eb;
            color: #666;
        }

        .btn-cancel:hover {
            background: #d1d5db;
        }

        .btn-submit {
            background: #667eea;
            color: white;
        }

        .btn-submit:hover {
            background: #5568d3;
        }

        .admin-actions {
            margin-top: 20px;
        }

        .btn-danger {
            width: 100%;
            padding: 15px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-danger:disabled {
            background: #d1d5db;
            cursor: not-allowed;
        }

        @media (max-width: 768px) {
            body {
                padding: 12px 8px;
            }

            header {
                padding: 16px 14px 10px;
            }

            .stat-card,
            .chart-card,
            .data-table {
                padding: 16px 12px;
            }

            .section-panel {
                padding: 1.25rem 0.875rem !important;
            }

            #results-access-section {
                padding: 16px 12px !important;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            #leaderboardGrid {
                grid-template-columns: repeat(2, 1fr) !important;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 8px 4px;
            }

            header {
                padding: 12px 10px 8px;
            }

            .stat-card,
            .chart-card,
            .data-table {
                padding: 12px 8px;
            }

            .section-panel {
                padding: 1rem 0.625rem !important;
            }

            #results-access-section {
                padding: 12px 8px !important;
            }

            #leaderboardGrid {
                grid-template-columns: 1fr !important;
            }
        }
        
        /* Study Details Modal */
        .study-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            align-items: center;
            justify-content: center;
        }
        
        .study-modal.active {
            display: flex;
        }
        
        .study-modal-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        .study-modal-close {
            float: right;
            font-size: 2rem;
            font-weight: bold;
            color: #9ca3af;
            cursor: pointer;
            line-height: 1;
        }
        
        .study-modal-close:hover {
            color: #374151;
        }
        
        .leaderboard-tab:hover {
            color: #20B2AA !important;
        }
    </style>
  <script type="module" crossorigin src="/assets/dashboard-CR-zBYNh.js"></script>
  <link rel="modulepreload" crossorigin href="/assets/modulepreload-polyfill-B5Qt9EMX.js">
</head>
<body>
    <div class="container">
        <header>
            <h1><img id="dashboard-logo" src="unlock-lab-icon.svg" alt="Unlock the Lab" class="dashboard-logo"> Unlock the Lab - Live Dashboard</h1>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="avgScore">0</div>
                <div class="stat-label">Average Score</div>
                <p style="font-size: 0.75rem; color: #9ca3af; margin-top: 0.5rem;">Mean prediction accuracy score across all participants</p>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalRatings">0</div>
                <div class="stat-label">Total Ratings</div>
                <p style="font-size: 0.75rem; color: #9ca3af; margin-top: 0.5rem;">Number of study ratings submitted by all participants</p>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="uniqueParticipants">0</div>
                <div class="stat-label">Participants</div>
                <p style="font-size: 0.75rem; color: #9ca3af; margin-top: 0.5rem;">Total number of different users who have submitted ratings</p>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="activeParticipants">0</div>
                <div class="stat-label">Active Now</div>
                <p style="font-size: 0.75rem; color: #9ca3af; margin-top: 0.5rem;">Users currently rating studies (active in last 60 seconds)</p>
            </div>
        </div>

        <!-- Review Your Results Section -->
        <div id="results-access-section" class="stat-card" style="margin-bottom: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; text-shadow: 0 1px 3px rgba(0,0,0,0.3);">
            <h2 style="color: white; margin-bottom: 15px; font-weight: 600;">üìä Review Your Results</h2>
            <p style="margin-bottom: 15px; font-size: 0.95rem; font-weight: 400;">Completed the workshop? Enter your username below to view your personalised results page.</p>
            <div id="results-link-display" style="display: none; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 8px; margin-bottom: 10px;">
                <p style="margin-bottom: 10px; font-size: 0.9rem;">Your session was detected!</p>
                <button onclick="goToMyResults()" style="padding: 12px 24px; background: white; color: #667eea; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: transform 0.2s;">
                    üîç View my results
                </button>
            </div>
            <div id="results-manual-entry">
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <input type="text" id="sessionLinkInput" placeholder="Enter your username..." style="flex: 1; min-width: 250px; max-width: 400px; padding: 12px; border: 2px solid rgba(255,255,255,0.3); border-radius: 8px; font-size: 0.95rem; background: rgba(255,255,255,0.9);">
                    <button onclick="loadFromLink()" style="padding: 12px 24px; background: white; color: #667eea; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: transform 0.2s; white-space: nowrap;">
                        üîç View my results
                    </button>
                </div>
                <p id="link-error" style="display: none; color: #fecaca; font-size: 0.85rem; margin-top: 10px;">‚ö†Ô∏è Please enter a valid username.</p>
            </div>
        </div>

        <!-- SECTION 1: PREDICTION PERFORMANCE -->
        <div class="section-panel" style="margin-bottom: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border-radius: 12px; color: white;">
            <h2 style="margin-top: 0; color: white; font-size: 1.8rem; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 0.75rem;">
                üéØ Part 1: Prediction Performance
            </h2>
            <p style="font-size: 1rem; margin-bottom: 0; opacity: 0.95;">
                How well did participants predict what others would rate each study?
            </p>
        </div>

        <!-- Leaderboard Section -->
        <div class="data-table" style="margin-bottom: 40px;">
            <h2 style="color: #059669; margin-bottom: 10px;">üèÜ Top Predictors</h2>
            <p style="font-size: 0.85rem; color: #6b7280; margin-bottom: 15px;">Top performers ranked by prediction accuracy. Scores show how well participants predicted crowd ratings. The leaderboard includes all participants who have submitted at least one rating. <strong>Click any entry to view that participant's personalised results page.</strong></p>
            
            <!-- Leaderboard Tabs -->
            <div style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #e5e7eb;">
                <button id="tabAllTime" class="leaderboard-tab active" onclick="switchLeaderboardTab('allTime')" style="padding: 10px 20px; border: none; background: none; color: #059669; font-weight: bold; cursor: pointer; border-bottom: 3px solid #059669; transition: all 0.2s;">
                    üåü All-time leaders
                </button>
                <button id="tab24h" class="leaderboard-tab" onclick="switchLeaderboardTab('24h')" style="padding: 10px 20px; border: none; background: none; color: #6b7280; font-weight: normal; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.2s;">
                    üìÖ Past 24 hours
                </button>
            </div>
            
            <div id="leaderboardGrid" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px;">
                <div style="text-align: center; color: #999; grid-column: 1 / -1;">Loading leaderboard...</div>
            </div>
        </div>

        <!-- SECTION 1b: CRITERION IMPORTANCE -->
        <div class="data-table" style="margin-bottom: 40px;">
            <h2 id="criterion-importance-heading" style="color: #d97706; margin-bottom: 10px;">‚öñÔ∏è Criterion Importance</h2>
            <p style="font-size: 0.85rem; color: #6b7280; margin-bottom: 20px;">Average percentage of tokens assigned to each criterion by participants, reflecting what they considered most important when evaluating study quality. Error bars show 95% confidence intervals for the mean percentage across participants. <span id="criterion-importance-count"></span></p>
            <div id="criterion-importance-container">
                <p style="text-align: center; color: #999; padding: 2rem 0;">No data yet.</p>
            </div>
        </div>

        <!-- SECTION 2: RATING PATTERNS -->
        <div class="section-panel" style="margin-bottom: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.3);">
            <h2 style="margin-top: 0; color: white; font-size: 1.8rem; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 0.75rem; font-weight: 600;">
                üìä Part 2: Rating Patterns
            </h2>
            <p style="font-size: 1rem; margin-bottom: 0; opacity: 0.95; font-weight: 400;">
                How did participants actually rate the quality of each study?
            </p>
        </div>

        <div class="charts-grid">
            <div class="chart-card" style="grid-column: 1 / -1;">
                <h2 id="ratings-chart-heading">üìä Average Quality Ratings by Study</h2>
                <p id="ratings-chart-desc" style="font-size: 0.85rem; color: #6b7280; margin-bottom: 1rem;">Mean quality rating (1-7 scale) with 95% confidence intervals. Error bars show rating variability‚Äîwider bars indicate less agreement among participants. All participants with at least one valid rating are included. The leaderboard shows the subset who completed the full workshop. <strong>Click on any bar to view detailed statistics and study information.</strong></p>
                <div class="chart-container">
                    <canvas id="ratingsChart"></canvas>
                </div>
            </div>
        </div>

        <div class="data-table">
            <h2 style="color: #20B2AA; margin-bottom: 10px;">üìà Detailed Rating Statistics</h2>
            <p style="font-size: 0.85rem; color: #6b7280; margin-bottom: 20px;">Complete breakdown of how participants rated each study's quality. Std Dev measures disagreement (higher = more variable ratings). Agreement % shows consensus level. Color scales highlight relative values. <strong>Click study names to view detailed information.</strong> Click column headers to sort.</p>
            <table id="statsTable">
                <thead>
                    <tr>
                        <th class="sortable" onclick="sortTable(0, 'string')" title="Click to sort">Study</th>
                        <th class="sortable" onclick="sortTable(1, 'string')" title="Click to sort">Quality</th>
                        <th class="sortable" onclick="sortTable(2, 'number')" title="Click to sort">Responses</th>
                        <th class="sortable" onclick="sortTable(3, 'number')" title="Click to sort">Mean Rating</th>
                        <th class="sortable" onclick="sortTable(4, 'number')" title="Click to sort">Std Dev</th>
                        <th class="sortable" onclick="sortTable(5, 'number')" title="Click to sort">Min</th>
                        <th class="sortable" onclick="sortTable(6, 'number')" title="Click to sort">Max</th>
                        <th class="sortable" onclick="sortTable(7, 'number')" title="Click to sort">Agreement %</th>
                    </tr>
                </thead>
                <tbody id="statsTableBody">
                    <tr><td colspan="8" style="text-align: center; color: #999;">Loading data...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Study Details Modal -->
    <div class="study-modal" id="studyModal" onclick="closeStudyModal()">
        <div class="study-modal-content" onclick="event.stopPropagation()">
            <span class="study-modal-close" onclick="closeStudyModal()">&times;</span>
            <div id="studyDetailsContent">
                <h2 id="studyTitle"></h2>
                <p id="studyQuality"></p>
                <div id="studyStats"></div>
            </div>
        </div>
    </div>
    
    <!-- Authorship & Project Info -->
    <div style="max-width: 1400px; margin: 2rem auto 0; padding: 1.25rem; background: #f8fafc; border-radius: 8px; font-size: 0.9rem; color: #64748b;">
        <p style="margin-bottom: 0.5rem;"><strong>Author:</strong> Dr Pablo Bernabeu, Department of Education, University of Oxford</p>
        <p style="margin-bottom: 0.5rem; font-size: 0.85rem; color: #64748b;"><strong>Legal disclaimer:</strong> This app and workshop were created by Dr Pablo Bernabeu in a personal capacity during spare time. The employer is not affiliated with, does not endorse, and bears no liability for this app or workshop.</p>
        <p style="margin-bottom: 0.5rem;"><strong>Materials:</strong> <a href="https://github.com/pablobernabeu/Unlock_the_Lab" target="_blank" rel="noopener noreferrer" style="color: #2563eb; text-decoration: none; border-bottom: 1px solid #2563eb;">github.com/pablobernabeu/Unlock_the_Lab</a></p>
        <p style="margin-bottom: 0.5rem;"><strong>Licence:</strong> <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" style="color: #2563eb; text-decoration: none;">CC BY 4.0</a> ‚Äî Free to use with attribution</p>
        <p style="margin-bottom: 0; font-size: 0.85rem; font-style: italic;">üí° Contributions welcome! Suggest improvements or report issues on <a href="https://github.com/pablobernabeu/Unlock_the_Lab/issues" target="_blank" rel="noopener noreferrer" style="color: #2563eb; text-decoration: none; border-bottom: 1px solid #2563eb;">GitHub</a>.</p>
    </div>
    
    <!-- Admin Link -->
    <p style="max-width: 1400px; margin: 2rem auto; padding-right: 20px; text-align: right; font-size: 0.8rem;"><a href="#" onclick="openAdminPanel(); return false;" style="color: #94a3b8; text-decoration: none; cursor: pointer;">Admin</a></p>

    <!-- Admin Overlay -->
    <div class="admin-overlay" id="adminOverlay" onclick="closeAdminPanel(event)">
        <div class="admin-panel" onclick="event.stopPropagation()">
            <h3 id="adminTitle">üîê Admin Access</h3>
            
            <div id="passwordSection">
                <input 
                    type="email" 
                    id="adminEmail" 
                    class="admin-input" 
                    placeholder="Admin email"
                    onkeypress="handlePasswordKeyPress(event)"
                    autofocus
                >
                <input 
                    type="password" 
                    id="adminPassword" 
                    class="admin-input" 
                    placeholder="Password"
                    onkeypress="handlePasswordKeyPress(event)"
                >
                <div class="admin-timer" id="adminTimer">Time remaining: 10s</div>
                <div class="admin-buttons">
                    <button class="btn-cancel" onclick="closeAdminPanel()">Cancel</button>
                    <button class="btn-submit" onclick="verifyPassword()" id="loginBtn">Sign in</button>
                </div>
            </div>

            <div id="adminActions" style="display: none;">
                <p style="color: #666; margin-bottom: 15px;" id="adminEmail"></p>
                
                <!-- Firebase Usage Statistics (Admin Only) -->
                <div style="margin-bottom: 20px; padding: 15px; background: #f8fafc; border: 2px solid #e5e7eb; border-radius: 8px;">
                    <h4 style="color: #20B2AA; margin-bottom: 12px; font-size: 1rem;">üìä Firebase Usage (Free Tier Limits)</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        <div style="padding: 12px; background: white; border-radius: 6px; border-left: 4px solid #20B2AA;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                <span style="font-weight: 600; color: #374151; font-size: 0.85rem;">Connections</span>
                                <span id="connectionUsage" style="font-size: 1.1rem; font-weight: bold; color: #10b981;">0/100</span>
                            </div>
                            <div style="height: 6px; background: #e5e7eb; border-radius: 3px; overflow: hidden;">
                                <div id="connectionBar" style="height: 100%; background: #10b981; width: 0%; transition: all 0.3s;"></div>
                            </div>
                            <p style="font-size: 0.7rem; color: #6b7280; margin-top: 6px; margin-bottom: 0;">Active in last 60s</p>
                        </div>
                        <div style="padding: 12px; background: white; border-radius: 6px; border-left: 4px solid #3b82f6;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                <span style="font-weight: 600; color: #374151; font-size: 0.85rem;">Storage</span>
                                <span id="storageUsage" style="font-size: 1.1rem; font-weight: bold; color: #10b981;">~0 MB</span>
                            </div>
                            <div style="height: 6px; background: #e5e7eb; border-radius: 3px; overflow: hidden;">
                                <div id="storageBar" style="height: 100%; background: #10b981; width: 0%; transition: all 0.3s;"></div>
                            </div>
                            <p style="font-size: 0.7rem; color: #6b7280; margin-top: 6px; margin-bottom: 0;">1 GB limit</p>
                        </div>
                        <div style="padding: 12px; background: white; border-radius: 6px; border-left: 4px solid #f59e0b;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                <span style="font-weight: 600; color: #374151; font-size: 0.85rem;">Sessions</span>
                                <span id="sessionCount" style="font-size: 1.1rem; font-weight: bold; color: #20B2AA;">0</span>
                            </div>
                            <p style="font-size: 0.7rem; color: #6b7280; margin-top: 6px; margin-bottom: 0;">Completed</p>
                        </div>
                    </div>
                    <p style="font-size: 0.75rem; color: #64748b; margin-top: 12px; margin-bottom: 0;"><strong>Note:</strong> Free tier: 100 connections, 1 GB storage, 10 GB/month downloads.</p>
                </div>
                
                <div class="admin-actions">
                    <button class="btn-danger" onclick="endAllSessions()" id="endSessionsBtn">
                        ‚èπÔ∏è End all active sessions
                    </button>
                    <button class="btn-danger" onclick="deleteAllRatingsData()" id="deleteDataBtn" style="margin-top: 10px;">
                        üóëÔ∏è Delete all ratings data
                    </button>
                </div>
                <div class="admin-buttons" style="margin-top: 15px;">
                    <button class="btn-cancel" onclick="adminSignOut()" style="background: #ef4444; color: white;">Sign out</button>
                    <button class="btn-cancel" onclick="closeAdminPanel()">Close</button>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
