import"./modulepreload-polyfill-B5Qt9EMX.js";import{o as w,s as b,a as u,b as h,d as r}from"./firebase-config-BPW_mu1B.js";import{r as d,a as m,g as c}from"./firebase-4YSElDcj.js";w(u,e=>{e?(v(),g()):E()});window.handleLoginKeyPress=function(e){e.key==="Enter"&&loginWithPassword()};window.loginWithPassword=async function(){const e=document.getElementById("login-error"),t=document.getElementById("adminEmail").value,s=document.getElementById("adminPassword").value;if(!t||!s){e.textContent="‚ùå Please enter both email and password",e.style.display="block";return}const a=document.getElementById("loginBtn");a.disabled=!0,a.textContent="Signing in...";try{await b(u,t,s),e.style.display="none",document.getElementById("adminPassword").value=""}catch(n){console.error("Sign-in error:",n);let o="Authentication failed";n.code==="auth/invalid-credential"||n.code==="auth/wrong-password"||n.code==="auth/user-not-found"?o="Invalid email or password":n.code==="auth/too-many-requests"?o="Too many failed attempts. Try again later":n.code==="auth/invalid-email"&&(o="Invalid email address"),e.textContent=`‚ùå ${o}`,e.style.display="block",document.getElementById("adminPassword").value=""}finally{a.disabled=!1,a.textContent="üîê Sign In"}};window.logoutAdmin=async function(){await h(u)};function E(){document.getElementById("login-section").style.display="block",document.getElementById("admin-panel").style.display="none"}function v(){document.getElementById("login-section").style.display="none",document.getElementById("admin-panel").style.display="block"}async function g(){try{const e=d(r,"active"),t=await c(e),s=t.exists()?Object.keys(t.val()).length:0;document.getElementById("active-count").textContent=s;const a=d(r,"ratings"),n=await c(a);let o=0;if(n.exists()){const p=n.val();Object.values(p).forEach(f=>{o+=Object.keys(f).length})}document.getElementById("total-ratings").textContent=o;const l=d(r,"leaderboard"),i=await c(l),y=i.exists()?Object.keys(i.val()).length:0;document.getElementById("leaderboard-count").textContent=y}catch(e){console.error("Error loading stats:",e)}}window.stopAllSessions=async function(){if(!confirm("Are you sure you want to stop all active sessions? This will force all participants to start new sessions."))return;const e=document.getElementById("action-result");e.innerHTML='<p style="color: #f59e0b;">‚è≥ Stopping all sessions...</p>';try{const t=d(r,"active");await m(t),e.innerHTML='<p style="color: #10b981; padding: 1rem; background: #d1fae5; border-radius: 4px;">‚úÖ All active sessions have been stopped successfully.</p>',await g()}catch(t){e.innerHTML=`<p style="color: #ef4444; padding: 1rem; background: #fef2f2; border-radius: 4px;">‚ùå Error: ${t.message}</p>`}};window.deleteAllRatings=async function(){const e=d(r,"ratings"),t=await c(e);if(!t.exists()){alert("‚ÑπÔ∏è No ratings data to delete.");return}const s=t.val();let a=0;Object.values(s).forEach(i=>{a+=Object.keys(i).length});const n=`‚ö†Ô∏è WARNING: You are about to permanently delete ${a} rating(s) across all studies.

This action CANNOT be undone!

Type "DELETE" to confirm:`;if(prompt(n)!=="DELETE"){alert("‚ùå Deletion cancelled.");return}const l=document.getElementById("delete-result");l.innerHTML='<p style="color: #f59e0b;">‚è≥ Deleting all ratings data...</p>';try{await m(e),l.innerHTML='<p style="color: #10b981; padding: 1rem; background: #d1fae5; border-radius: 4px;">‚úÖ All ratings data has been permanently deleted.</p>',await g()}catch(i){l.innerHTML=`<p style="color: #ef4444; padding: 1rem; background: #fef2f2; border-radius: 4px;">‚ùå Error: ${i.message}</p>`}};window.auth=u;window.database=r;
