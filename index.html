<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unlock the Lab Workshop</title>
    <link rel="icon" type="image/x-icon" href="img/favicon.ico">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- Score Display (appears after first rating) -->
        <div id="score-banner" class="score-banner" style="display: none;">
            <span id="total-score-header"><span class="medal-icon">ğŸ†</span> 0</span>
            <div class="navbar-right">
                <span id="navbar-paper-number" class="navbar-paper-number" style="display: none;"></span>
                <span id="navbar-username" class="navbar-username"></span>
            </div>
        </div>
        
        <!-- Page 1: Welcome -->
        <div class="page active" id="page-welcome">
            <div class="container">
                <h1><img id="logo-icon" src="unlock-lab-icon.svg" alt="Unlock the Lab" style="height: 1.8em; vertical-align: middle; margin-right: 0.3em; margin-top: -0.15em; cursor: pointer;"> Unlock the Lab</h1>
                <h2>Your Guide to Reading Science Like a Scientist</h2>
                
                <div class="content">
                    <p class="intro-text">"Chocolate makes you smarter!"â€”Headlines promise miracles and threaten disasters, but what does the actual science say?</p>
                    
                    <p>In this interactive workshop, you'll become a science detective. You'll evaluate real-world research scenarios using the same criteria professional scientists use to judge quality.</p>
                    
                    <div class="info-box" style="background: #fff3cd; border-left: 4px solid #ffc107;">
                        <h3 style="margin-top: 0;">ğŸ¯ Your Mission</h3>
                        <p><strong>Dual Challenge:</strong> For each study, you must:</p>
                        <ol style="margin: 10px 0; padding-left: 2.5rem;">
                            <li><strong>Predict the crowd</strong> â€” Guess what others will rate it on average</li>
                            <li><strong>Judge the science</strong> â€” Rate quality using expert criteria (1-7)</li>
                        </ol>
                        <p style="margin-bottom: 0.75rem;"><strong>Scoring:</strong> Points awarded based on prediction accuracy. Can you think like a scientist AND understand how the public perceives research?</p>
                        <p style="font-size: 0.9rem; color: #856404; margin-bottom: 0;"><strong>Why both?</strong> This dual approach allows you to express your own beliefs about research quality while also reflecting on how those beliefs might differ from others' perspectives.</p>
                    </div>
                    
                    <h3>ğŸ“š What You'll Learn:</h3>
                    <ul class="skills-list">
                        <li>âœ… Spot red flags in research (predatory journals, hidden data, clickbait)</li>
                        <li>âœ… Distinguish good science from marketing disguised as research</li>
                        <li>âœ… Understand why open access and transparency matter</li>
                        <li>âœ… Evaluate methodology, sample sizes, and conclusions critically</li>
                    </ul>
                    
                    <p class="highlight" style="font-size: 1.1rem; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 8px; text-align: center; text-shadow: 0 1px 3px rgba(0,0,0,0.3); font-weight: 500;">ğŸ’¡ First, you'll learn the tools. Then, you'll test your skills on real scenarios!</p>
                    
                    <div style="margin-top: 2rem; padding: 1.25rem; background: #fff3e0; border: 2px solid #ff9800; border-radius: 8px;">
                        <h3 style="margin-top: 0; color: #e65100; font-size: 1rem;">ğŸ† Leaderboard & Anonymous Usernames</h3>
                        <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 0.75rem;">Complete all studies to appear on the <strong>public leaderboard</strong> and see how your prediction accuracy compares with others!</p>
                        <ul style="font-size: 0.9rem; line-height: 1.6; margin: 0.75rem 0; padding-left: 1.5rem;">
                            <li>You'll be assigned a <strong>unique anonymous username</strong> (e.g., "Red Fox", "Wise Owl") automatically.</li>
                            <li>Your username will be displayed on the <strong>results page at the end</strong>.</li>
                            <li>Rankings are based on how accurately you predict the crowd's average ratings.</li>
                            <li>Earn badges (ğŸ†ğŸ¥‡ğŸ¥ˆğŸ¥‰) based on your prediction accuracy score.</li>
                        </ul>
                        <p style="font-size: 0.85rem; color: #64748b; margin-bottom: 0;">View the live leaderboard at any time on the <a href="dashboard.html" target="_blank" style="color: #2563eb;">public dashboard</a>.</p>
                    </div>
                    
                    <div style="margin-top: 2rem; padding: 1.25rem; background: #f0f9ff; border: 2px solid #3b82f6; border-radius: 8px;">
                        <h3 style="margin-top: 0; color: #1e40af; font-size: 1rem;">ğŸ“Š Data Use Notice</h3>
                        <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 0.75rem;">By participating in this task, you agree that your <strong>anonymous data will be used for research purposes</strong> and may be shared and analysed.</p>
                        <ul style="font-size: 0.9rem; line-height: 1.6; margin: 0.75rem 0; padding-left: 1.5rem;">
                            <li>Your data is identified only by an <strong>automatically assigned anonymous username</strong>.</li>
                            <li>Your username will be displayed on the <strong>results page at the end</strong>.</li>
                            <li>You need not share this username with anyone if you do not wish to.</li>
                            <li><strong>No demographic details</strong> or personally identifiable information is collected.</li>
                        </ul>
                        <p style="font-size: 0.85rem; color: #64748b; margin-bottom: 0;">All data is fully anonymised and used solely for understanding how people evaluate research quality.</p>
                    </div>
                    
                    <div style="margin-top: 2rem; padding: 1rem; background: #f8fafc; border-radius: 8px; font-size: 0.9rem; color: #64748b;">
                        <p style="margin-bottom: 0.5rem;"><strong>Author:</strong> Dr Pablo Bernabeu, Department of Education, University of Oxford</p>
                        <p style="margin-bottom: 0.5rem;"><strong>Materials:</strong> <a href="https://github.com/pablobernabeu/Unlock_the_Lab" target="_blank" rel="noopener noreferrer" style="color: #2563eb;">github.com/pablobernabeu/Unlock_the_Lab</a></p>
                        <p style="margin-bottom: 0.5rem;"><strong>Licence:</strong> <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" style="color: #2563eb;">CC BY 4.0</a> â€” Free to use with attribution</p>
                        <p style="margin-bottom: 0; font-size: 0.85rem; font-style: italic;">ğŸ’¡ Contributions welcome! Suggest improvements or report issues on <a href="https://github.com/pablobernabeu/Unlock_the_Lab/issues" target="_blank" rel="noopener noreferrer" style="color: #2563eb;">GitHub</a>.</p>
                    </div>
                </div>
                
                <button class="btn-primary" onclick="nextPage()" style="margin-top: 1.5rem;">Get started</button>
                
                <!-- Admin Link -->
                <p style="text-align: right; margin-top: 3rem; font-size: 0.8rem;"><a href="admin.html" style="color: #94a3b8; text-decoration: none;">Admin</a></p>
            </div>
        </div>

        <!-- Page 2: Glossary and Rubric -->
        <div class="page" id="page-guide">
            <div class="container">
                <h1>ğŸ“š Before We Begin</h1>
                
                <div class="content">
                    <div class="info-box" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
                        <p style="margin: 0;"><strong>ğŸ“– Take your time with these resources!</strong> They're the foundation for evaluating research quality. You can return to them anytime using the ğŸ“– button.</p>
                    </div>
                    
                    <h2 style="margin-top: 1.5rem;">ğŸ“š Scientific Glossary</h2>
                    <p style="color: #666; margin-bottom: 1rem;">Key terms you'll encounter when evaluating research:</p>
                    <div id="glossary-content"></div>
                    
                    <h2 style="margin-top: 2.5rem;">âš–ï¸ Quality Rating Rubric (1-7 Scale)</h2>
                    <p style="color: #666; margin-bottom: 1rem;">Use these six criteria to rate each study. Consider all aspects together for your final score:</p>
                    <div id="rubric-content"></div>
                    
                    <div class="info-box" style="margin-top: 2rem; background: #f3e5f5; border-left: 4px solid #9c27b0;">
                        <p style="margin: 0 0 0.5rem 0;"><strong>ğŸ’¡ Scoring Strategy:</strong> You can weigh some criteria more strongly than others when forming your overall rating.</p>
                        <p style="margin: 0; font-size: 0.9rem; color: #666;"><strong>Note:</strong> The order in which criteria appear will rotate across studies to ensure balanced assessment.</p>
                    </div>
                </div>
                
                <div style="display: flex; gap: 1rem; justify-content: space-between;">
                    <button class="btn-secondary" onclick="previousPage()">â† Back</button>
                    <button class="btn-primary" onclick="nextPage()">Start rating papers â†’</button>
                </div>
            </div>
        </div>

        <!-- Paper Pages (Generated Dynamically) -->
        <div id="paper-pages"></div>

        <!-- Final Page: Recap -->
        <div class="page" id="page-final">
            <div class="container">
                <h1>ğŸ‰ Workshop Complete!</h1>
                
                <div class="content">
                    
                    <!-- PART 1: PREDICTION PERFORMANCE -->
                    <div style="margin-bottom: 3rem; padding: 2rem; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border-radius: 12px; color: white;">
                        <h2 style="margin-top: 0; color: white; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 1rem;">
                            ğŸ¯ Part 1: Your Prediction Performance
                        </h2>
                        <p style="font-size: 1.05rem; margin-bottom: 1.5rem;">
                            How well did you predict what others would rate each study?
                        </p>
                        
                        <div class="final-score-card" style="background: white; color: #1f2937;">
                            <h3 style="color: #059669;">Your Prediction Accuracy Score</h3>
                            <div class="final-score" id="final-score">0</div>
                            <div class="score-rank" id="score-rank">Calculating rank...</div>
                            <p style="font-size: 0.9rem; color: #666; margin-top: 1rem;">
                                This score measures how accurately you predicted the crowd's average ratings. Higher scores mean better predictions!
                            </p>
                        </div>
                        
                        <div class="leaderboard" style="background: rgba(255,255,255,0.95); border-radius: 8px; padding: 1.5rem; margin-top: 1.5rem;">
                            <h3 style="color: #059669; margin-top: 0;">ğŸ† Top Predictors</h3>
                            <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                                See how your prediction accuracy compares to other participants
                            </p>
                            <div id="leaderboard-list">Loading...</div>
                        </div>
                    </div>
                    
                    <!-- PART 2: YOUR RATING PROFILE -->
                    <div style="margin-bottom: 3rem; padding: 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                        <h2 style="margin-top: 0; color: white; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 1rem; font-weight: 600;">
                            ğŸ“Š Part 2: Your Rating Profile
                        </h2>
                        <p style="font-size: 1.05rem; margin-bottom: 1.5rem; font-weight: 400;">
                            How did your own quality ratings compare to the crowd's ratings?
                        </p>
                        
                        <!-- Personalized Rating Analysis -->
                        <div id="rating-analysis" style="display: none;">
                            <div style="background: rgba(255,255,255,0.95); color: #1f2937; padding: 1.5rem; border-radius: 12px; margin: 1rem 0;">
                                <p id="analysis-summary" style="font-size: 1.05rem; line-height: 1.7; margin: 0;"></p>
                            </div>
                            <div style="background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin: 1rem 0;">
                                <h3 style="color: #20B2AA; margin-top: 0;">Your Ratings vs. Crowd Average</h3>
                                <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                                    This chart shows how your quality ratings (purple line) compared to what other participants rated on average (green dashed line).
                                </p>
                                <canvas id="comparison-chart" style="max-height: 250px; width: 100%;"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <h2>You've evaluated <span id="total-papers">0</span> research papers!</h2>
                    <ul style="line-height: 1.8;">
                        <li><strong>ğŸ”“ Open Access</strong> â€” Paywalls hide science from public scrutiny. Demand transparency!</li>
                        <li><strong>ğŸš¨ Spotting Clickbait</strong> â€” Sensational headlines usually mean weak science underneath</li>
                        <li><strong>ğŸ”¬ Methodology Matters</strong> â€” Sample sizes, controls, and open data separate real from fake</li>
                        <li><strong>ğŸ“š Source Credibility</strong> â€” Predatory journals publish anything for money. Trust matters</li>
                        <li><strong>âš–ï¸ Nuanced Conclusions</strong> â€” Good scientists admit what they don't know. Beware certainty!</li>
                        <li><strong>ğŸŒ Crowd vs. Experts</strong> â€” You learned how public perception differs from scientific quality</li>
                    </ul>
                    
                    <div class="info-box">
                        <h3>Keep Exploring Science!</h3>
                        <p>When reading science news:</p>
                        <ul>
                            <li>Look for the original research paper</li>
                            <li>Check if data is openly available</li>
                            <li>Question sensational claims</li>
                            <li>Consider the source and methodology</li>
                        </ul>
                    </div>
                    
                    <div style="text-align: center; margin-top: 2rem;">
                        <h3>Curious About the Results?</h3>
                        <p>See how all participants rated the studies, including average scores, rating distributions, and agreement levels across the group.</p>
                        <a href="dashboard.html" class="btn-primary" style="display: inline-block; text-decoration: none; margin-top: 1rem;">
                            ğŸ“Š View Live Dashboard
                        </a>
                        <p style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">
                            Real-time ratings and statistics from all participants
                        </p>
                        
                        <!-- Save Your Results Section -->
                        <div style="margin-top: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                            <h3 style="margin-top: 0; color: white; font-weight: 600;">ğŸ’¾ Save Your Results</h3>
                            <p style="margin-bottom: 1rem; font-size: 0.95rem; font-weight: 400;">
                                Want to review your personalized analysis later? Save your results link now! You can return to this page anytime to see:
                            </p>
                            <ul style="margin-bottom: 1rem; padding-left: 1.5rem; font-size: 0.9rem; list-style: disc; list-style-position: outside; font-weight: 400;">
                                <li style="margin-bottom: 0.5rem;">Your rating profile and statistical comparison</li>
                                <li style="margin-bottom: 0.5rem;">How your ratings compare to the crowd average</li>
                                <li style="margin-bottom: 0.5rem;">Your complete prediction accuracy scores</li>
                            </ul>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
                                <button id="save-results-link" class="btn-secondary" style="display: none; padding: 0.75rem 1.5rem; background: white; color: #667eea; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; font-weight: 600;" onclick="copyResultsLink()">
                                    ğŸ”— Copy link to your results
                                </button>
                                <button id="email-results-link" class="btn-secondary" style="display: none; padding: 0.75rem 1.5rem; background: white; color: #667eea; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; font-weight: 600;" onclick="emailResultsLink()">
                                    ğŸ“§ Email my results
                                </button>
                            </div>
                            <p id="link-copied-msg" style="display: none; font-size: 0.9rem; color: #fef3c7; margin-top: 0.75rem; text-align: center;">
                                âœ“ Link copied! Save it to return to your results anytime.
                            </p>
                            <p style="margin-top: 1.5rem; font-size: 0.9rem; font-weight: 400; text-align: center;">
                                Or visit the <a href="dashboard.html" style="color: white; text-decoration: underline; font-weight: bold; text-shadow: 0 1px 3px rgba(0,0,0,0.4);">live dashboard</a> and enter your name (<strong id="username-display-inline" style="font-weight: 600;"></strong>) to find your results.
                            </p>
                        </div>
                        
                    </div>
                    
                    <p style="text-align: center; margin-top: 2rem; font-size: 1.2rem;">
                        Thank you for participating! ğŸ”¬âœ¨
                    </p>
                    
                    <div style="margin-top: 2.5rem; padding: 1.5rem; background: #f8fafc; border-radius: 8px; border-left: 4px solid #2563eb;">
                        <h3 style="margin-top: 0; color: #2563eb;">ğŸ“‹ Workshop Information</h3>
                        <p style="margin-bottom: 0.75rem; color: #64748b;"><strong>Author:</strong> Dr Pablo Bernabeu<br>Department of Education, University of Oxford</p>
                        <p style="margin-bottom: 0.75rem; color: #64748b;"><strong>App Materials:</strong> <a href="https://github.com/pablobernabeu/Unlock_the_Lab" target="_blank" rel="noopener noreferrer" style="color: #2563eb; text-decoration: none; border-bottom: 1px solid #2563eb;">github.com/pablobernabeu/Unlock_the_Lab</a></p>
                        <p style="margin-bottom: 0; color: #64748b;"><strong>Licence:</strong> <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" style="color: #2563eb; text-decoration: none; border-bottom: 1px solid #2563eb;">CC BY 4.0 Attribution</a> â€” You're free to use and adapt these materials provided you acknowledge the authorship.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Help Button (appears on paper pages) -->
    <button id="help-button" class="floating-btn" onclick="showHelp()">
        ğŸ“–
    </button>

    <!-- Modal for Glossary/Rubric -->
    <div id="help-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeHelp()">&times;</span>
            <div class="modal-tabs">
                <button class="tab-btn active" onclick="showTab('glossary')">Glossary</button>
                <button class="tab-btn" onclick="showTab('rubric')">Rating rubric</button>
            </div>
            <div id="modal-glossary" class="tab-content active"></div>
            <div id="modal-rubric" class="tab-content"></div>
        </div>
    </div>

    <!-- App Scripts (ES Modules) -->
    <script type="module" src="/app.js"></script>
</body>
</html>
